<?xml version = "1.0" encoding = "UTF-8"?>

<!-- Definición del vocabulario -->

<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">

    <xs:annotation>
        <xs:documentation xml:lang  = "es-es" >
			<fichero>LMSGI-RA4c-Empleados-XMLSchema-referencia</fichero>
			<fechaCreacion>02-02-2023</fechaCreacion>
			<autor>david fernandez viota</autor>
			<aplicación>Ejemplo de diseño de XML-Schema con referencias.</aplicación>
            <utilidad>Vocabulario para la validación de ficheros básicos para la gestión de un parte de incidencias</utilidad> 
        </xs:documentation>
    </xs:annotation>

	<!-- ************** -->
	<!-- TIPOS DE DATOS -->
	<!-- ************** -->

	<xs:simpleType name = "tipoNombre" >
		<xs:restriction base = "xs:string" >
			<xs:maxLength value = "40" />
			<xs:pattern value = "([A-Z][a-z]+ ?)(([A-Z]|[a-z])[a-z]+ ?)*" />
		</xs:restriction>
	</xs:simpleType>

	<xs:simpleType name = "tipoCurso" >
		<xs:restriction base = "xs:string">
			<xs:pattern value = "\d{1}º([A-Z]¨{20})"/>
		</xs:restriction>
	</xs:simpleType>

    <xs:simpleType name = "tipoConductasLeves" >
		<xs:restriction base = "xs:string">
			<xs:enumeration value="a"/>
            <xs:enumeration value="b"/>
            <xs:enumeration value="c"/>
            <xs:enumeration value="d"/>
            <xs:enumeration value="e"/>
            <xs:enumeration value="f"/>
            <xs:enumeration value="g"/>
            <xs:enumeration value="h"/>
            <xs:enumeration value="i"/>
            <xs:enumeration value="j"/>
            <xs:enumeration value="k"/>
		</xs:restriction>
	</xs:simpleType>

    <xs:simpleType name = "tipoConductasGraves" >
		<xs:restriction base = "xs:string">
			<xs:enumeration value="a"/>
            <xs:enumeration value="b"/>
            <xs:enumeration value="c"/>
            <xs:enumeration value="d"/>
            <xs:enumeration value="e"/>
            <xs:enumeration value="f"/>
            <xs:enumeration value="g"/>
            <xs:enumeration value="h"/>
            <xs:enumeration value="i"/>
            <xs:enumeration value="j"/>
            <xs:enumeration value="k"/>
            <xs:enumeration value="l"/>
            <xs:enumeration value="m"/>
		</xs:restriction>
	</xs:simpleType>

    <xs:simpleType name = "tipoPregunta" >
		<xs:restriction base = "xs:string">
			<xs:maxLength value = "1000" />
			<xs:pattern value = "([A-Z][a-z]+ ?)(([A-Z]|[a-z])[a-z]+ ?)*"/>
		</xs:restriction>
	</xs:simpleType>
    <!-- Definición del ejemplar: factura -->
	
	<xs:element name = "factura" >
		<xs:complexType>
			<xs:sequence>
				<xs:element ref = "identificacion" />
				<xs:element ref = "conductas" />
				<xs:element ref = "firmas" />
				<xs:element ref = "observaciones" />
				<xs:element ref = "firmaProfesor"/>
                <xs:element ref = "firmaJefatura"/>
                <xs:element ref = "firmaConvivencia"/>
			</xs:sequence>
		</xs:complexType>
	</xs:element>
	
	<!-- Fin ejemplar -->
	<!-- ************************** -->
	<!-- Definición del vocabulario -->
	<!-- ************************** -->

    <xs:element name="ParteIncidencias">
        <xs:complexType>
            <xs:sequence>
                <xs:element ref="identificacion"/>
                <xs:element ref="conductas"/>
                <xs:element ref="firmas"/>
			</xs:sequence> 
		</xs:complexType>
	</xs:element>

	<!--DEFINICION DE IDENTIFICACION -->
	<xs:element name="identificacion">
		<xs:complexType>
        	<xs:sequence>
                <xs:element name="alumno" type="tipoNombre"/>
                <xs:element name="dia" type="xs:date"/>
            	<xs:element name="curso" type="tipoCurso"/>
                <xs:element name="Modulo" type="tipoNombre"/>
        	</xs:sequence>
		</xs:complexType>
	</xs:element>
    
    <!--DEFINICION DE CONDUCTAS-->
    <xs:element name="conductas">
		<xs:complexType>
        	<xs:sequence>
                <xs:element name="ConductasContrarias" type="tipoConductasLeves"/>
                <xs:element name="ConductasGraves" type="tipoConductasGraves"/>
            	<xs:element ref="observaciones"/>
        	</xs:sequence>
		</xs:complexType>
	</xs:element>
    <!--DEFINICION DE OBSERVACIONES-->
    <xs:element name="observaciones">
		<xs:complexType>
        	<xs:sequence>
                <xs:element name="alumno" type="tipoNombre"/>
                <xs:element name="grupo" type="tipoNombre"/>
            	<xs:element name="lugar" type="tipoNombre"/>
                <xs:element name="implicados" type="tipoNombre"/>
                <xs:element name="preguntas" type="tipoNombre" maxOccurs="5"/>
        	</xs:sequence>
		</xs:complexType>
	</xs:element>
    <!--DEFINICION DE FIRMAS-->
    <xs:element name="firmas">
		<xs:complexType>
        	<xs:sequence>
                <xs:element ref="firmaProfesor"/>
                <xs:element ref="firmaJefatura"/>
                <xs:element ref="firmaConvivencia"/>
                <xs:element name="firmaPadres"/>
                <xs:element name="firmaAlumno"/>
        	</xs:sequence>
		</xs:complexType>
	</xs:element>
    <!--DEFINICION DE FIRMaProf-->
    <xs:element name="firmaProfesor">
		<xs:complexType>
        	<xs:sequence>
                <xs:element name="hora" type="xs:dateTime"/>
                <xs:element name="firma"/>
                <xs:element name="profesor" type="tipoNombre"/>
        	</xs:sequence>
		</xs:complexType>
    </xs:element>
    <!--DEFINICION DE FIRMAJEFATURA-->
    <xs:element name="firmaJefatura">
		<xs:complexType>
        	<xs:sequence>
                <xs:element name="hora" type="xs:dateTime"/>
                <xs:element name="firma"/>
        	</xs:sequence>
		</xs:complexType>
    </xs:element>
     <!--DEFINICION DE FIRMAConvicencia-->
     <xs:element name="firmaConvivencia">
		<xs:complexType>
        	<xs:sequence>
                <xs:element name="hora" type="xs:dateTime"/>
                <xs:element name="firma"/>
        	</xs:sequence>
		</xs:complexType>
    </xs:element>
</xs:schema>
 